#include "vt_imu"
#include "vt_kalman"
#include <iostream>
#include <vector>

using namespace vt;

constexpr real_t dt               = 0.1;
constexpr real_t hdts             = 0.5 * dt * dt;
constexpr real_t base_noise_value = 0.1;

constexpr auto F  = make_numeric_matrix<3, 3>({{1, dt, hdts},
                                               {0, 1, dt},
                                               {0, 0, 1}});
constexpr auto B  = make_numeric_matrix<3, 1>();
constexpr auto H  = make_numeric_matrix<1, 3>({{1, 0, 0}});
auto Q            = numeric_matrix<3, 3>::diagonals(base_noise_value);
auto R            = numeric_matrix<1, 1>::diagonals(base_noise_value);
constexpr auto x0 = make_numeric_vector<3>({0, 0, 0});  // {x, v, a}

adaptive_kalman_filter_t<3, 1, 1> kf(F, B, H, Q, R, x0, 0.001, 0.001);

int main() {
    std::vector py = {
            -8.837706878632009,
            -19.74508131068061,
            15.545382963105684,
            34.877708283800864,
            51.019514296785374,
            61.36724613444609,
            77.6463042886131,
            99.5907487562742,
            77.9520683533623,
            103.150800930027,
            131.4394312790667,
            145.76034215707963,
            138.8711206655136,
            138.22200209328474,
            178.97897883811825,
            171.03635173696327,
            185.13642169657513,
            200.26461166829247,
            216.99575420832952,
            232.38405574901344,
            243.15995719849496,
            248.27059977817947,
            268.83088805113834,
            274.76536731497083,
            272.7552255713659,
            308.7505340918067,
            316.64614625024177,
            330.06202177618695,
            340.9965187947994,
            340.3821688920966,
            363.24428153319013,
            373.69655398912664,
            373.4093993312336,
            385.3471651769489,
            394.4986690619548,
            418.1980033349413,
            429.08929209707895,
            425.91406659075716,
            443.57259689633474,
            443.5825229039575,
            464.10459469491195,
            481.59452881249655,
            506.99670080279776,
            495.14214141746254,
            512.6418137642484,
            524.0828437075997,
            536.080942077131,
            548.5550357903812,
            576.9981706846008,
            572.2648005420422,
            594.6944467288472,
            586.8323551721257,
            619.0849938288867,
            610.0920835882823,
            622.0488129118219,
            630.4109347319715,
            642.0045089920437,
            662.2473615205117,
            666.5982270126536,
            672.079317724723,
            696.890709131808,
            710.1454861907923,
            718.1564463828528,
            720.2857151257139,
            756.1943218304457,
            722.2704154807623,
            733.3809383659985,
            771.5382420784445,
            783.6385844853335,
            786.2540742147684,
            787.3724622560069,
            793.190837393157,
            816.1349980861386,
            828.1700844519628,
            845.7802321209684,
            840.4766436002064,
            831.2012282994141,
            876.6570995511694,
            870.1058034211491,
            879.0231794084181,
            874.496786464824,
            917.2967124302381,
            926.2060504028369,
            933.8092113618268,
            940.214050576432,
            938.1319614402591,
            969.1582760327098,
            949.1357240370523,
            984.762797478717,
            983.40730408459,
            992.811467177699,
            1007.3171673047783,
            1007.3265548277004,
            1021.8534475385735,
            1033.6306670339436,
            1022.8692931898406,
            1069.7932614102858,
            1068.2381849025692,
            1101.736166961044,
            1089.4635815016454,
            1082.7750803554459,
            1098.5839221429499,
            1122.9829960130542,
            1114.6874764636827,
            1124.032625620498,
            1142.4763016201882,
            1170.9992153641729,
            1147.81394473686,
            1176.450094101706,
            1192.9093170137483,
            1197.423686687844,
            1203.8159008970035,
            1212.0473304332413,
            1220.6675149427133,
            1214.8991769196016,
            1225.5585605888493,
            1260.967857420624,
            1242.6414958134626,
            1274.7597064925399,
            1265.2123828368774,
            1277.5115205506759,
            1292.6566269800442,
            1303.1227964172747,
            1338.7472015655646,
            1331.2643116181716,
            1338.5429675485939,
            1332.9832580218208,
            1372.350545396582,
            1359.9618683489202,
            1362.8929259371234,
            1360.9783529149256,
            1397.0723734071453,
            1395.0751348815108,
            1398.5812049238807,
            1400.3553136563692,
            1409.656098373634,
            1426.5925449678373,
            1414.399027640858,
            1462.3414862327536,
            1451.5556585100442,
            1470.3457600666154,
            1468.2890772485919,
            1492.8349542863004,
            1504.5078968401651,
            1500.5757064125082,
            1525.8078904970987,
            1524.6195959472477,
            1524.4971086081525,
            1524.9636747676657,
            1554.012375231481,
            1543.8526548672178,
            1556.8841017123655,
            1575.964907330612,
            1585.3020522459028,
            1595.8307688584491,
            1606.4918180962038,
            1607.6777305233184,
            1590.5964537443078,
            1626.4351366227027,
            1615.9951876746638,
            1655.297807638397,
            1643.405368854354,
            1662.3162898321718,
            1655.1058877667797,
            1671.8721811223115,
            1678.3655415210155,
            1686.4582647733334,
            1716.6113711141388,
            1710.5229695890423,
            1711.303729458563,
            1721.1732548482562,
            1727.149056859296,
            1760.7678645171093,
            1751.210583911557,
            1767.1074944044603,
            1754.6360642697566,
            1768.0550031106643,
            1770.4736862281475,
            1780.1963221316473,
            1794.3641877784682,
            1794.8745641794337,
            1795.2407271265613,
            1795.1118155692513,
            1823.9473990941053,
            1815.7780647545046,
            1857.0249431697248,
            1850.3605827671024,
            1865.7010456007029,
            1858.2937254244334,
            1868.3193184413556,
            1869.3648504346322,
            1887.84636482148,
            1908.4341190147532,
            1906.7640619424353,
            1909.3371646114208,
            1905.3743115228929,
            1931.0429386300175,
            1929.234537068132,
            1929.8386941448618,
            1934.6171875789612,
            1971.8448271322234,
            1964.1728897686537,
            1950.3832827054102,
            1971.1830028875636,
            1977.8394897490482,
            1985.9961997388434,
            2004.9324700080315,
            1990.6137215475776,
            1989.9613445920597,
            2019.4487625755387,
            2015.2219835540263,
            2024.8596499906423,
            2048.997484751842,
            2061.6587994226975,
            2051.348737549799,
            2049.8408578996286,
            2065.100814905531,
            2066.7246398187717,
            2072.739159519405,
            2069.8995973699243,
            2105.002458166694,
            2104.068988449781,
            2104.7196040174545,
            2130.927165937632,
            2106.6003986038427,
            2102.6568495023093,
            2124.4725096600177,
            2132.2769184764265,
            2139.463536693902,
            2141.787118326256,
            2147.6844709318034,
            2163.3366485255215,
            2163.918460155554,
            2182.2685136618925,
            2178.821620990184,
            2203.56696816108,
            2221.213292897893,
            2193.4522073581843,
            2201.394490520458,
            2210.443062972593,
            2219.928721392187,
            2222.828998663974,
            2237.2132036191524,
            2245.1301587990656,
            2243.407173669636,
            2263.0982956603443,
            2269.779476693922,
            2246.025026526299,
            2262.1793791367404,
            2294.5253921295366,
            2266.9999636927278,
            2293.2238104395537,
            2302.144123137504,
            2298.22162264454,
            2307.0715986567548,
            2317.344168631081,
            2334.4787376209806,
            2340.918858268203,
            2314.875546460828,
            2345.0513598137773,
            2352.016548116677,
            2355.7415137477915,
            2356.347747032692,
            2363.664876607697,
            2371.5552572779525,
            2374.5749383559796,
            2371.22720557418,
            2364.5236743330047,
            2399.50544995024,
            2395.2039047885387,
            2386.833069731521,
            2421.135218336655,
            2422.5644658323517,
            2412.1277303544434,
            2415.2539272661816,
            2448.391050458854,
            2450.027090451583,
            2453.1286901983235,
            2453.6821653549164,
            2459.5070088839616,
            2456.582251316315,
            2464.2354435871102,
            2470.4419134620007,
            2467.725624618203,
            2484.315968330454,
            2493.882425177635,
            2502.6886014607862,
            2482.584129285718,
            2495.607270081583,
            2503.0793750455437,
            2527.263183537811,
            2508.8952672128275,
            2525.9743539170645,
            2529.053922874039,
            2540.5674381816702,
            2524.614854748865,
            2548.6269550517827,
            2552.448119137583,
            2539.328714914838,
            2535.0695888223368,
            2565.1369052702958,
            2559.881272315014,
            2566.0498349898394,
            2575.2021235952457,
            2582.036959569142,
            2597.6039895149033,
            2584.821611976001,
            2586.895052993875,
            2610.800333569461,
            2614.291354201358,
            2605.2723120040077,
            2625.1414531350097,
            2613.1222305528777,
            2598.9393430084674,
            2652.5469303462824,
            2640.11100041538,
            2626.5781675147787,
            2654.228610614656,
            2628.9093215468965,
            2649.7094700319803,
            2655.2581313948094,
            2659.874266592554,
            2679.035421051126,
            2683.046453850379,
            2665.735245823729,
            2660.9551477317705,
            2694.6598790080316,
            2685.896579311575,
            2689.4784892492276,
            2693.6061675411574,
            2686.161139616691,
            2675.586740331552,
            2720.6467684552813,
            2674.8332247436656,
            2708.2593545559985,
            2705.4673259533483,
            2724.4468639801044,
            2717.7645083679417,
            2725.165128902531,
            2725.6890057892597,
            2743.1972119245547,
            2741.994814819975,
            2739.06518655085,
            2750.581686033977,
            2752.276746248646,
            2747.843667216145,
            2756.5960375849277,
            2765.55775879432,
            2772.023958573505,
            2766.6857039206493,
            2783.92039989186,
            2776.218698706014,
            2785.912738020155,
            2789.780284596359,
            2775.6914233646,
            2785.706203619706,
            2782.099357095327,
            2806.852656191455,
            2796.2521235225913,
            2805.7240314858122,
            2803.753013055136,
            2816.710622759203,
            2814.960807277875,
            2819.7303033871676,
            2831.8731113061926,
            2822.779544724196,
            2840.931920189184,
            2838.765124805325,
            2840.9677511568834,
            2818.799724228369,
            2833.6252879125327,
            2849.8537764596476,
            2851.81852376115,
            2850.1692402825292,
            2841.2831061600286,
            2862.9863976813926,
            2848.8510484601697,
            2874.09500629359,
            2854.1529551365275,
            2866.929521049887,
            2892.2575030175335,
            2880.8876686111084,
            2880.0901571781797,
            2864.202499056145,
            2894.0507688767925,
            2888.96210922736,
            2899.892985546231,
            2875.9816490691924,
            2879.48246801141,
            2916.2899873486103,
            2896.448874370848,
            2925.84051591613,
            2905.985222680588,
            2916.694495121543,
            2936.101615041745,
            2925.5390182911106,
            2923.0677008483667,
            2911.7056559198777,
            2922.7151429086016,
            2917.2062936379543,
            2919.650391785701,
            2937.403029301621,
            2926.2776797480474,
            2908.710332990369,
            2940.163949614191,
            2928.4909795890117,
            2934.720564742908,
            2953.016502433037,
            2947.404636350409,
            2942.4749134074555,
            2945.839822427399,
            2959.4993493641805,
            2959.655894887333,
            2968.360984066529,
            2982.949836281863,
            2971.229037700885,
            2966.142865134211,
            2957.702121545084,
            2948.0680533934988,
            2979.978516022336,
            2972.3909144316845,
            2962.285945809584,
            2966.0225389760217,
            2968.665906045231,
            2955.723910601608,
            2955.8544327847317,
            3001.0463743359846,
            2982.2155360349825,
            2971.5950400616675,
            2988.6744117954304,
            2975.6763183095222,
            2992.5424154199018,
            2976.5793987086695,
            2989.1717852592333,
            2991.887272424864,
            2989.324374135912,
            2995.7100456461335,
            2991.800697731145,
            3007.7188958503,
            3018.7530298801526,
            3008.987629462174,
            3012.7020350570397,
            3001.925131955805,
            3015.6460727354442,
            3019.7146937795983,
            2995.5813098358044,
            2996.8831231471395,
            3020.285480355011,
            3012.5850223416696,
            3015.330110802341,
            3009.0840518243845,
            3030.6762204890692,
            3020.0546239520195,
            3011.4705832927375,
            3027.7668952784175,
            3023.77583247671,
            3029.0423105140594,
            3023.060127680781,
            3038.111299252889,
            3037.882470173815,
            3033.7201848542254,
            3027.5738876104792,
            3037.250022266781,
            3040.4420772870812,
            3031.600829872608,
            3044.6117316484083,
            3033.115476988292,
            3055.696451325077,
            3038.7990095787886,
            3027.8490330886907,
            3039.1154046469524,
            3036.11188177895,
            3039.4735284990547,
            3023.5760007324766,
            3039.386150320569,
            3029.649281636388,
            3046.8287409771815,
            3042.983722339286,
            3032.6312193988774,
            3066.7363322483784,
            3028.4670939289126,
            3065.775749939897,
            3041.0225438629814,
            3054.4132011343913,
            3062.614843981645,
            3051.959657422684,
            3054.0047647840142,
            3047.2188801120856,
            3048.876728500066,
            3063.5754347191764,
            3044.7389464168837,
            3042.0342836652576,
            3038.1233022567917,
            3050.251583551299,
            3068.3266422885995,
            3047.152687883603,
            3050.8580980050747,
            3051.1636517660463,
            3051.4774211077806,
            3053.060180604146,
            3031.6299955394434,
            3050.565227924925,
            3029.3222131818766,
            3053.0409927113305,
            3057.225774369085,
            3054.993437488702,
            3054.580707970792,
            3047.1876556190105,
            3045.728300580952,
            3051.018076783877,
            3057.071440936471,
            3043.7461839026423,
            3056.720563074059,
            3037.263934730255,
            3028.323658362811,
            3051.07596742246,
            3046.5560462094077,
            3039.04825995229,
            3039.1438134065547,
            3057.7103053531096,
            3038.9185201431837,
            3039.7719532608176,
            3049.951704249587,
            3031.090801664557,
            3046.3935292163865,
            3031.3821215589305,
            3031.9110698604068,
            3052.268236734386,
            3024.487525786945,
            3038.56462724846,
            3008.8263489113247,
            3032.303705058785,
            3038.42154092725,
            3034.908984556029,
            3047.166127333159,
            3036.016409990027,
            3034.2669884163183,
            3015.1636988500077,
            3032.7202709410867,
            3036.2042590907863,
            3026.7758002703026,
            3020.50786417376,
            3045.998479169546,
            3035.980455381093,
            3030.3561990362928,
            3031.5186972009133,
            3026.397529744327,
            3023.4993564670317,
            3015.1825955568934,
            3022.3577157173663,
            3021.86131503828,
            3011.760072597384,
            3010.717427687675,
            3019.5510509521955,
            3010.965243192099,
            3018.979056785746,
            3008.4766176955322,
            2999.8074623523207,
            2999.46873359755,
            2997.9830197057686,
            2990.9553588010576,
            3013.9394738218457,
            3001.108076059381,
            2995.222479343229,
            2993.7604868783515,
            2998.643021035485,
            2976.344129935464,
            2992.3574991232576,
            3008.287700180265,
            2988.8584522251404,
            2986.5347437754604,
            2998.2570880102253,
            2969.4345779038035,
            2974.529340079442,
            2988.385891571726,
            2978.0625182458657,
            2976.236456111535,
            2974.981880558159,
            2990.9498752696595,
            2962.202190699114,
            2966.0403079230846,
            2973.424208551281,
            2965.899848414162,
            2967.929945714353,
            2951.1053234838914,
            2960.8150321329554,
            2968.0130372618432,
            2953.329924362571,
            2963.197050273207,
            2946.6787014876963,
            2950.361113570654,
            2949.3913763939813,
            2952.7719691752513,
            2946.989639468714,
            2937.1167816241577,
            2954.570127797071,
            2936.5372035731375,
            2941.0075527179083,
            2928.3448462503306,
            2935.681258393956,
            2935.437393702714,
            2926.9725103634128,
            2902.0849596083826,
            2902.185157688856,
            2925.434623051283,
            2915.5471081891633,
            2920.1281940042068,
            2913.821374430289,
            2910.979756726664,
            2913.1167278879634,
            2894.2859575574557,
            2883.671684218883,
            2886.89479364517,
            2885.2686651186737,
            2881.804324606638,
            2885.058198002565,
            2898.9030281022597,
            2871.0435742479954,
            2877.8217534112437,
            2865.140495614113,
            2869.919597982434,
            2866.643119701881,
            2873.1370337905482,
            2855.574131510081,
            2863.716472736358,
            2865.360816599241,
            2860.074971599058,
            2855.1891904051,
            2855.4595481588094,
            2840.416262168741,
            2851.452664207822,
            2845.581888492922,
            2830.3174767567884,
            2836.6759224474044,
            2822.8082995304007,
            2833.0712289935473,
            2825.04850460673,
            2803.626928370856,
            2833.006001372699,
            2805.1636553565213,
            2811.676492635247,
            2808.6397988207764,
            2775.588074423173,
            2796.8774302818883,
            2797.0118343640006,
            2780.0334517328147,
            2800.813876191656,
            2802.334472104942,
            2795.4696376290863,
            2773.1255330032945,
            2788.919899993008,
            2758.4396180486633,
            2764.813482040729,
            2760.1572572832238,
            2753.641856453081,
            2743.378499387925,
            2752.1053695985506,
            2751.2645848529332,
            2729.3456058764464,
            2753.5814092522614,
            2730.5608331054154,
            2712.923493813128,
            2735.2339881600524,
            2721.295546033354,
            2712.251830257819,
            2706.0257334428784,
            2720.8675058588715,
            2718.323039543568,
            2719.519889298404,
            2684.624275771603,
            2693.2998316862922,
            2694.9759354254948,
            2709.0136591076675,
            2685.3671980577906,
            2691.9575882734875,
            2681.609029115925,
            2681.0053251684944,
            2657.82519518134,
            2667.768363105696,
            2656.9151682838624,
            2652.7246114720488,
            2622.308536786364,
            2639.867790729218,
            2646.145410607918,
            2641.9888711623253,
            2621.3387066764485,
            2640.3993771439273,
            2621.3225331001167,
            2604.399398797836,
            2600.982332543008,
            2619.1133514944995,
            2613.9813396508575,
            2600.5251304072767,
            2592.790056001639,
            2601.74945403853,
            2596.0505588142246,
            2555.596110023045,
            2570.3773638994157,
            2584.847409633444,
            2569.698369993412,
            2536.564610578591,
            2547.8044033777214,
            2555.355114361004,
            2532.3212457310196,
            2542.340820092788,
            2534.3913539424348,
            2526.5175956593475,
            2504.229669711649,
            2514.4857133249593,
            2515.877209963619,
            2509.4608056517777,
            2498.3029445177776,
            2505.7312262189175,
            2498.9468363248516,
            2479.6965601862794,
            2482.2346067504322,
            2470.239756958431,
            2464.1442522616344,
            2472.5819405226634,
            2485.2016564846253,
            2447.2151621652524,
            2460.8005798353383,
            2460.434131922572,
            2441.265041391789,
            2432.8185458979274,
            2432.710998191601,
            2418.4082680559286,
            2422.416770638589,
            2417.9449003663485,
            2398.780533270688,
            2392.3975240277773,
            2392.1128440538423,
            2396.2684277679177,
            2396.6997676580827,
            2394.070793746893,
            2381.844646740289,
            2362.384293576492,
            2352.1926405882127,
            2369.9181863315275,
            2339.5865232542433,
            2351.7298391936015,
            2344.967165986409,
            2323.4304009824227,
            2317.969111352675,
            2318.561960873609,
            2306.058377943857,
            2313.110421678516,
            2316.685733193566,
            2273.358577817762,
            2295.739250310549,
            2294.060059986517,
            2283.511205312442,
            2290.124215813471,
            2278.9729672308,
            2256.285105173378,
            2236.9848934738866,
            2244.8227576565537,
            2235.4376175736534,
            2227.5343760769197,
            2227.1621617077517,
            2198.3435115886127,
            2227.7656299475757,
            2218.4109380124664,
            2188.836344764228,
            2208.43562359283,
            2182.349363737398,
            2182.620616520292,
            2170.5753950541075,
            2158.3095629970962,
            2145.4278660747163,
            2157.6005241115927,
            2152.113330319592,
            2128.2979127833432,
            2117.145986677247,
            2133.0207000889986,
            2139.7749276631175,
            2104.612159511234,
            2122.5884889469444,
            2103.410730249257,
            2094.0077968760247,
            2105.6511613340153,
            2096.2789890951994,
            2071.2565832907444,
            2079.707835915507,
            2056.626086512928,
            2062.768218883326,
            2053.550810318666,
            2050.0551659560897,
            2048.4918502613823,
            2041.873410649706,
            2018.441091514684,
            2013.3282758269893,
            2022.233205371825,
            1988.0426847150763,
            2015.0480466372126,
            1997.728940346398,
            1958.8720658433517,
            1971.8458776070906,
            1954.9298789800491,
            1954.832909461928,
            1947.5101366132233,
            1944.1914185691714,
            1930.9538386640713,
            1939.9527558824486,
            1911.560292356023,
            1934.7624814031517,
            1909.9136426105479,
            1911.7052785524154,
            1901.9754072216713,
            1886.8449809948254,
            1881.4086172435839,
            1876.282082971246,
            1858.5760276857661,
            1853.9404336451062,
            1858.6113812633803,
            1827.7818354032863,
            1827.8842863340128,
            1834.2022008904416,
            1827.5531555486211,
            1818.05864558659,
            1789.7329181456064,
            1787.8866670030823,
            1790.5934841060518,
            1776.0381683658698,
            1752.0886746385254,
            1755.461068890991,
            1749.14574033038,
            1750.8160261810226,
            1742.730968481131,
            1748.4138515939749,
            1710.3742167578957,
            1703.6985400089386,
            1693.2208455210175,
            1700.3627721585626,
            1689.542921764322,
            1676.2840003321558,
            1680.7950456488634,
            1683.0801457215314,
            1647.3126150191056,
            1643.3112116788122,
            1652.43580862429,
            1631.4500338344028,
            1618.9007321627603,
            1623.134744446571,
            1603.3939001040874,
            1597.850485295546,
            1579.297230688545,
            1584.3185350593533,
            1551.328884802352,
            1559.6258033774925,
            1547.1498699107763,
            1518.067808998662,
            1533.6184088422394,
            1533.4575426055003,
            1532.6351015570208,
            1521.9613669144846,
            1496.0693437834589,
            1492.070456895866,
            1490.1570165366084,
            1457.21774326674,
            1474.155424046892,
            1458.7864323405659,
            1462.1817743875813,
            1444.2132718308897,
            1440.9030741661213,
            1426.9498322053353,
            1418.4788560647517,
            1400.8157093589043,
            1401.611618823471,
            1386.589433529059,
            1376.187054373992,
            1362.8442319301491,
            1358.6133408629894,
            1354.2940648942838,
            1347.9046734033857,
            1335.7996222217564,
            1315.7171661806738,
            1321.7831159943082,
            1305.7966896726,
            1298.8423175682121,
            1284.719471151071,
            1298.359656777434,
            1262.666118527998,
            1260.9502914288662,
            1244.7591729323274,
            1232.867574766671,
            1238.2927796250226,
            1224.5962204553157,
            1223.8105832019503,
            1195.4676569440876,
            1200.0181845643062,
            1187.4658759977754,
            1160.8189802564316,
            1177.367165067778,
            1161.4723443396583,
            1163.7055433759829,
            1135.889612582609,
            1112.1777402532878,
            1134.9466392857564,
            1116.3945555033235,
            1100.026998318081,
            1095.8637182991506,
            1076.846953705611,
            1074.4433590494193,
            1055.5862550504512,
            1046.0554339005575,
            1028.1289345349303,
            1037.4017356657846,
            1025.6503828995462,
            1018.0593855204698,
            1003.204210006612,
            1001.835344774072,
            972.9671504812525,
            968.3765709189872,
            967.9228146003128,
            961.7401920445391,
            937.673908015122,
            916.0850114738853,
            911.8326316431084,
            911.8002053984073,
            877.1446118500345,
            886.3203404609219,
            874.3096364038664,
            858.4016750188403,
            845.2630646383113,
            847.2491890325354,
            822.4523879664329,
            828.3565330594687,
            815.9369938253651,
            799.8624106426504,
            792.1579645775984,
            783.2514548716902,
            767.0316601983598,
            778.8197528589844,
            754.3595534162024,
            743.8895273781815,
            730.6980785066842,
            717.7227460124134,
            709.9024364745974,
            688.9378067822084,
            697.7529962867972,
            670.6053144462862,
            668.3455018194841,
            652.9640606946501,
            630.9231737249801,
            639.1508055362557,
            623.4021057648049,
            599.7433107268488,
            605.6131555356627,
            576.9552022713098,
            590.6585233718909,
            562.0399211749375,
            564.8853786399311,
            555.7726631602964,
            539.7164087487383,
            532.836622211585,
            501.82049344030975,
            522.3555565704349,
            515.1799460328604,
            477.1576237794672,
            460.6475183583179,
            458.9410930711909,
            432.9844969978863,
            443.60038889270356,
            441.8309361876984,
            418.45333964809817,
            407.0499957129185,
            404.12287704856857,
            364.1192052615036,
            367.4221269888843,
            341.7021752202949,
            346.03277440549476,
            346.0651872035591,
            327.7849254662809,
            318.07564543873593,
            306.8945273255951,
            279.77450001478644,
            270.1786928826885,
            254.34628941634855,
            250.63251145351487,
            219.38635160466208,
            229.04453404406817,
            230.58755281205526,
            190.76106148030817,
            196.24368550408116,
            176.50066022083365,
            175.70347342560328,
            174.525104607862,
            134.96268241035307,
            119.16785887032366,
            122.31330858786865,
            105.06162635557851,
            92.42026101310427,
            79.63262655536555,
            66.72423734112827,
            59.99386798371291,
            44.79305336611908,
            28.01131773513674,
            28.551338725301523,
            15.34256723972714,
            3.101663358315721,
    };

    size_t i = 0;
    for (const auto &y: py) {
        kf.predict().update(y);
        std::cout << static_cast<real_t>(i) * dt << ",";
        std::cout << y;
        for (auto &state: kf.state_vector) {
            printf(",%.4f", state);
        }
        std::cout << '\n';
        ++i;
    }

    return 0;
}
